{"version":3,"sources":["../src/lib/resolve-registry.ts"],"sourcesContent":["import fs from 'fs/promises';\nimport path from 'path';\n\nexport interface ResolveRegistryResult {\n  runtimeUrl: string;\n  persist: boolean;\n  existingConfig: any | null;\n}\n\nexport async function resolveRegistry(\n  cwd: string,\n  cliRegistry?: string,\n): Promise<ResolveRegistryResult> {\n  const configPath = path.join(cwd, 'selia.json');\n\n  let existingConfig: any = null;\n  try {\n    existingConfig = JSON.parse(await fs.readFile(configPath, 'utf-8'));\n  } catch {}\n\n  const isDev =\n    process.env.SELIA_DEV === '1' || process.env.NODE_ENV === 'development';\n\n  const defaultRegistry = isDev\n    ? 'http://localhost:5173/registry'\n    : 'https://selia.nauv.al/registry';\n\n  const runtimeUrl =\n    cliRegistry ||\n    existingConfig?.registries?.sources?.selia?.url ||\n    defaultRegistry;\n\n  const persist =\n    Boolean(cliRegistry) && !existingConfig?.registries?.sources?.selia;\n\n  return {\n    runtimeUrl,\n    persist,\n    existingConfig,\n  };\n}\n"],"mappings":";AAAA,OAAO,QAAQ;AACf,OAAO,UAAU;AAQjB,eAAsB,gBACpB,KACA,aACgC;AAChC,QAAM,aAAa,KAAK,KAAK,KAAK,YAAY;AAE9C,MAAI,iBAAsB;AAC1B,MAAI;AACF,qBAAiB,KAAK,MAAM,MAAM,GAAG,SAAS,YAAY,OAAO,CAAC;AAAA,EACpE,QAAQ;AAAA,EAAC;AAET,QAAM,QACJ,QAAQ,IAAI,cAAc,OAAO,QAAQ,IAAI,aAAa;AAE5D,QAAM,kBAAkB,QACpB,mCACA;AAEJ,QAAM,aACJ,eACA,gBAAgB,YAAY,SAAS,OAAO,OAC5C;AAEF,QAAM,UACJ,QAAQ,WAAW,KAAK,CAAC,gBAAgB,YAAY,SAAS;AAEhE,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,EACF;AACF;","names":[]}